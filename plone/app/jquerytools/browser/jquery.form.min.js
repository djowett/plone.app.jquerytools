(function(b){function L(a){var e=a.data;if(!a.isDefaultPrevented()){a.preventDefault();b(this).ajaxSubmit(e)}}function M(a){var e=a.target,i=b(e);if(!i.is(":submit,input:image")){e=i.closest(":submit");if(e.length==0)return;e=e[0]}var f=this;f.clk=e;if(e.type=="image")if(a.offsetX!=undefined){f.clk_x=a.offsetX;f.clk_y=a.offsetY}else if(typeof b.fn.offset=="function"){i=i.offset();f.clk_x=a.pageX-i.left;f.clk_y=a.pageY-i.top}else{f.clk_x=a.pageX-e.offsetLeft;f.clk_y=a.pageY-e.offsetTop}setTimeout(function(){f.clk=
f.clk_x=f.clk_y=null},100)}function p(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log)window.console.log(a);else window.opera&&window.opera.postError&&window.opera.postError(a)}}b.fn.ajaxSubmit=function(a){function e(k){for(var v=new FormData,x=0;x<k.length;x++)k[x].type!="file"&&v.append(k[x].name,k[x].value);j.find("input:file:enabled").each(function(){var n=b(this).attr("name"),s=this.files;if(n)for(var c=0;c<s.length;c++)v.append(n,
s[c])});if(a.extraData)for(var u in a.extraData)v.append(u,a.extraData[u]);a.data=null;k=b.extend(true,{},b.ajaxSettings,a,{contentType:false,processData:false,cache:false,type:"POST"});k.data=null;var o=k.beforeSend;k.beforeSend=function(n,s){s.data=v;if(n.upload)n.upload.onprogress=function(c){s.progress(c.position,c.total)};o&&o.call(s,n,a)};b.ajax(k)}function i(k){function v(h){return h=h.contentWindow?h.contentWindow.document:h.contentDocument?h.contentDocument:h.document}function x(){function h(){try{var E=
v(z).readyState;p("state = "+E);E.toLowerCase()=="uninitialized"&&setTimeout(h,50)}catch(F){p("Server abort: ",F," (",F.name,")");u(N);G&&clearTimeout(G);G=undefined}}var l=j.attr("target"),t=j.attr("action");o.setAttribute("target",H);f||o.setAttribute("method","POST");t!=c.url&&o.setAttribute("action",c.url);if(!c.skipEncodingOverride&&(!f||/post/i.test(f)))j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(c.timeout)G=setTimeout(function(){O=true;u(P)},c.timeout);var y=[];
try{if(c.extraData)for(var w in c.extraData)y.push(b('<input type="hidden" name="'+w+'">').attr("value",c.extraData[w]).appendTo(o)[0]);if(!c.iframeTarget){A.appendTo("body");z.attachEvent?z.attachEvent("onload",u):z.addEventListener("load",u,false)}setTimeout(h,15);o.submit()}finally{o.setAttribute("action",t);l?o.setAttribute("target",l):j.removeAttr("target");b(y).remove()}}function u(h){if(!(g.aborted||Q)){try{q=v(z)}catch(l){p("cannot access response document: ",l);h=N}if(h===P&&g)g.abort("timeout");
else if(h==N&&g)g.abort("server abort");else{if(!q||q.location.href==c.iframeSrc)if(!O)return;z.detachEvent?z.detachEvent("onload",u):z.removeEventListener("load",u,false);h="success";var t;try{if(O)throw"timeout";var y=c.dataType=="xml"||q.XMLDocument||b.isXMLDoc(q);p("isXml="+y);if(!y&&window.opera&&(q.body==null||q.body.innerHTML==""))if(--T){p("requeing onLoad callback, DOM not available");setTimeout(u,250);return}var w=q.body?q.body:q.documentElement;g.responseText=w?w.innerHTML:null;g.responseXML=
q.XMLDocument?q.XMLDocument:q;if(y)c.dataType="xml";g.getResponseHeader=function(U){var V={"content-type":c.dataType};return V[U]};if(w){g.status=Number(w.getAttribute("status"))||g.status;g.statusText=w.getAttribute("statusText")||g.statusText}var E=(c.dataType||"").toLowerCase(),F=/(json|script|text)/.test(E);if(F||c.textarea){var I=q.getElementsByTagName("textarea")[0];if(I){g.responseText=I.value;g.status=Number(I.getAttribute("status"))||g.status;g.statusText=I.getAttribute("statusText")||g.statusText}else if(F){var J=
q.getElementsByTagName("pre")[0],K=q.getElementsByTagName("body")[0];if(J)g.responseText=J.textContent?J.textContent:J.innerText;else if(K)g.responseText=K.textContent?K.textContent:K.innerText}}else if(E=="xml"&&!g.responseXML&&g.responseText!=null)g.responseXML=W(g.responseText);try{R=X(g,E,c)}catch(Y){h="parsererror";g.error=t=Y||h}}catch(S){p("error caught: ",S);h="error";g.error=t=S||h}if(g.aborted){p("upload aborted");h=null}if(g.status)h=g.status>=200&&g.status<300||g.status===304?"success":
"error";if(h==="success"){c.success&&c.success.call(c.context,R,"success",g);D&&b.event.trigger("ajaxSuccess",[g,c])}else if(h){if(t==undefined)t=g.statusText;c.error&&c.error.call(c.context,g,h,t);D&&b.event.trigger("ajaxError",[g,c,t])}D&&b.event.trigger("ajaxComplete",[g,c]);D&&!--b.active&&b.event.trigger("ajaxStop");c.complete&&c.complete.call(c.context,g,h);Q=true;c.timeout&&clearTimeout(G);setTimeout(function(){c.iframeTarget||A.remove();g.responseXML=null},100)}}}var o=j[0],n,s,c,D,H,A,z,
g,O,G;n=!!b.fn.prop;if(k)if(n)for(s=0;s<k.length;s++){n=b(o[k[s].name]);n.prop("disabled",false)}else for(s=0;s<k.length;s++){n=b(o[k[s].name]);n.removeAttr("disabled")}if(b(":input[name=submit],:input[id=submit]",o).length)alert('Error: Form elements must not have name or id of "submit".');else{c=b.extend(true,{},b.ajaxSettings,a);c.context=c.context||c;H="jqFormIO"+(new Date).getTime();if(c.iframeTarget){A=b(c.iframeTarget);n=A.attr("name");if(n==null)A.attr("name",H);else H=n}else{A=b('<iframe name="'+
H+'" src="'+c.iframeSrc+'" />');A.css({position:"absolute",top:"-1000px",left:"-1000px"})}z=A[0];g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(h){var l=h==="timeout"?"timeout":"aborted";p("aborting upload... "+l);this.aborted=1;A.attr("src",c.iframeSrc);g.error=l;c.error&&c.error.call(c.context,g,l,h);D&&b.event.trigger("ajaxError",[g,c,l]);c.complete&&c.complete.call(c.context,
g,l)}};(D=c.global)&&!b.active++&&b.event.trigger("ajaxStart");D&&b.event.trigger("ajaxSend",[g,c]);if(c.beforeSend&&c.beforeSend.call(c.context,g,c)===false)c.global&&b.active--;else if(!g.aborted){if(k=o.clk)if((n=k.name)&&!k.disabled){c.extraData=c.extraData||{};c.extraData[n]=k.value;if(k.type=="image"){c.extraData[n+".x"]=o.clk_x;c.extraData[n+".y"]=o.clk_y}}var P=1,N=2;k=b("meta[name=csrf-token]").attr("content");if((n=b("meta[name=csrf-param]").attr("content"))&&k){c.extraData=c.extraData||
{};c.extraData[n]=k}c.forceSync?x():setTimeout(x,10);var R,q,T=50,Q,W=b.parseXML||function(h,l){if(window.ActiveXObject){l=new ActiveXObject("Microsoft.XMLDOM");l.async="false";l.loadXML(h)}else l=(new DOMParser).parseFromString(h,"text/xml");return l&&l.documentElement&&l.documentElement.nodeName!="parsererror"?l:null},Z=b.parseJSON||function(h){return window.eval("("+h+")")},X=function(h,l,t){var y=h.getResponseHeader("content-type")||"",w=l==="xml"||!l&&y.indexOf("xml")>=0;h=w?h.responseXML:h.responseText;
w&&h.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");if(t&&t.dataFilter)h=t.dataFilter(h,l);if(typeof h==="string")if(l==="json"||!l&&y.indexOf("json")>=0)h=Z(h);else if(l==="script"||!l&&y.indexOf("javascript")>=0)b.globalEval(h);return h}}}}if(!this.length){p("ajaxSubmit: skipping submit process - no element selected");return this}var f,d,j=this;if(typeof a=="function")a={success:a};f=this.attr("method");d=this.attr("action");if(d=(d=typeof d==="string"?b.trim(d):"")||
window.location.href||"")d=(d.match(/^([^#]+)/)||[])[1];a=b.extend(true,{url:d,success:b.ajaxSettings.success,type:f||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);d={};this.trigger("form-pre-serialize",[this,a,d]);if(d.veto){p("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(a.beforeSerialize&&a.beforeSerialize(this,a)===false){p("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var m=a.traditional;if(m===
undefined)m=b.ajaxSettings.traditional;var r,B=this.formToArray(a.semantic);if(a.data){a.extraData=a.data;r=b.param(a.data,m)}if(a.beforeSubmit&&a.beforeSubmit(B,this,a)===false){p("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[B,this,a,d]);if(d.veto){p("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}d=b.param(B,m);if(r)d=d?d+"&"+r:r;if(a.type.toUpperCase()=="GET"){a.url+=(a.url.indexOf("?")>=0?"&":"?")+d;a.data=null}else a.data=
d;var C=[];a.resetForm&&C.push(function(){j.resetForm()});a.clearForm&&C.push(function(){j.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var $=a.success||function(){};C.push(function(k){var v=a.replaceTarget?"replaceWith":"html";b(a.target)[v](k).each($,arguments)})}else a.success&&C.push(a.success);a.success=function(k,v,x){for(var u=a.context||a,o=0,n=C.length;o<n;o++)C[o].apply(u,[k,v,x||j,j])};m=b("input:file:enabled[value]",this);r=m.length>0;d="multipart/form-data";d=j.attr("enctype")==
d||j.attr("encoding")==d;m=!!(r&&m.get(0).files&&window.FormData);p("fileAPI :"+m);var aa=(r||d)&&!m;if(a.iframe!==false&&(a.iframe||aa))a.closeKeepAlive?b.get(a.closeKeepAlive,function(){i(B)}):i(B);else if((r||d)&&m){a.progress=a.progress||b.noop;e(B)}else b.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&this.length===0){var e={s:this.selector,c:this.context};if(!b.isReady&&e.s){p("DOM not ready, queuing ajaxForm");
b(function(){b(e.s,e.c).ajaxForm(a)});return this}p("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}if(a.delegation){b(document).off("submit.form-plugin",this.selector,L).off("click.form-plugin",this.selector,M).on("submit.form-plugin",this.selector,a,L).on("click.form-plugin",this.selector,a,M);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",a,L).bind("click.form-plugin",a,M)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};
b.fn.formToArray=function(a){var e=[];if(this.length===0)return e;var i=this[0],f=a?i.getElementsByTagName("*"):i.elements;if(!f)return e;var d,j,m,r,B,C;d=0;for(B=f.length;d<B;d++){j=f[d];if(m=j.name)if(a&&i.clk&&j.type=="image"){if(!j.disabled&&i.clk==j){e.push({name:m,value:b(j).val(),type:j.type});e.push({name:m+".x",value:i.clk_x},{name:m+".y",value:i.clk_y})}}else if((r=b.fieldValue(j,true))&&r.constructor==Array){j=0;for(C=r.length;j<C;j++)e.push({name:m,value:r[j]})}else r!==null&&typeof r!=
"undefined"&&e.push({name:m,value:r,type:j.type})}if(!a&&i.clk){a=b(i.clk);f=a[0];if((m=f.name)&&!f.disabled&&f.type=="image"){e.push({name:m,value:a.val()});e.push({name:m+".x",value:i.clk_x},{name:m+".y",value:i.clk_y})}}return e};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var e=[];this.each(function(){var i=this.name;if(i){var f=b.fieldValue(this,a);if(f&&f.constructor==Array)for(var d=0,j=f.length;d<j;d++)e.push({name:i,value:f[d]});else f!==
null&&typeof f!="undefined"&&e.push({name:this.name,value:f})}});return b.param(e)};b.fn.fieldValue=function(a){for(var e=[],i=0,f=this.length;i<f;i++){var d=this[i];d=b.fieldValue(d,a);d===null||typeof d=="undefined"||d.constructor==Array&&!d.length||(d.constructor==Array?b.merge(e,d):e.push(d))}return e};b.fieldValue=function(a,e){var i=a.name,f=a.type,d=a.tagName.toLowerCase();if(e===undefined)e=true;if(e&&(!i||a.disabled||f=="reset"||f=="button"||(f=="checkbox"||f=="radio")&&!a.checked||(f=="submit"||
f=="image")&&a.form&&a.form.clk!=a||d=="select"&&a.selectedIndex==-1))return null;if(d=="select"){d=a.selectedIndex;if(d<0)return null;e=[];a=a.options;i=(f=f=="select-one")?d+1:a.length;for(d=f?d:0;d<i;d++){var j=a[d];if(j.selected){var m=j.value;m||(m=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(f)return m;e.push(m)}}return e}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=
b.fn.clearInputs=function(a){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,f=this.tagName.toLowerCase();if(e.test(i)||f=="textarea"||a&&/hidden/.test(i))this.value="";else if(i=="checkbox"||i=="radio")this.checked=false;else if(f=="select")this.selectedIndex=-1})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};
b.fn.enable=function(a){if(a===undefined)a=true;return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){if(a===undefined)a=true;return this.each(function(){var e=this.type;if(e=="checkbox"||e=="radio")this.checked=a;else if(this.tagName.toLowerCase()=="option"){e=b(this).parent("select");a&&e[0]&&e[0].type=="select-one"&&e.find("option").selected(false);this.selected=a}})};b.fn.ajaxSubmit.debug=false})(jQuery);

